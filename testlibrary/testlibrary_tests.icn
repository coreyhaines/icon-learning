link testlibrary

procedure main()
  equal_tests()
  listToString_tests()
  assertEqual_tests()
end

procedure listToString_tests()
  write("Testing listToString")
  assertEqual("[]", listToString([]))
  assertEqual("[1]", listToString([1]))
  assertEqual("[1, 2]", listToString([1,2]))
  assertEqual("[\"foo\", \"bar\"]", listToString(["foo", "bar"]))
end

procedure equal_tests()
  write("Testing equal")
  write((equal("foo", "foo"),"P: same string") | "F")
  write((equal("foo", "bar"),"F") | "P: different strings")

  write((equal(1, 1),"P: same number") | "F")
  write((equal(1, 2),"F") | "P: different numbers")

  write((equal([], []),"P: same list") | "F")
  write((equal([1], [1]),"P: same list") | "F")
  write((equal([1,2], [1,2]),"P: same list") | "F")
  write((equal([1], [2]),"F") | "P: different lists")
  write((equal([1], [2,3]),"F") | "P: different lists")
  write((equal([1,2], [1,3]),"F") | "P: different lists")
  write((equal([1,2,3], [1,2,4]),"F") | "P: different lists")
end

procedure assertEqual_tests()
  write("Testing assertEqual")
  string_tests()
  number_tests()
end

procedure string_tests()
  assertEqual("foo", "foo") # Expected pass
  assertEqual("foo", "bar") # Expected fail
end

procedure number_tests()
  assertEqual(1, 1) # Expected pass
  assertEqual(1, 2) # Expected fail
end
